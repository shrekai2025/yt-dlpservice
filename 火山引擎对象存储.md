火山引擎对象存储

本文介绍通过 TOS 控制台上传文件的操作步骤。
注意事项
上传文件前，请确保您已经创建存储桶。具体步骤，请参见创建存储桶。
文件名的命名规范，请参见文件说明。
简单上传方式最大能够上传 5GiB 文件。
使用控制台分片上传最大能够上传 50GiB 文件；如果您的文件大于 50GiB，您可以使用 API 上传，该方式最大支持上传 48.8TiB 文件（每个分片最大 5GiB，分片数量最多 10000）。具体步骤，请参见UploadPart。
操作步骤
登录对象存储控制台。
在左侧导航栏，单击桶列表，在桶列表页面单击目标桶名称。
在文件列表页面，单击上传文件，在上传文件页面，设置文件参数。
参数
说明
上传到
指定对象上传到 TOS 存储桶中的存储路径。
当前目录：将文件上传到当前目录下。
指定目录：可自定义目录名称，并将文件上传到该目录下。指定目录命名规范如下：
支持中文、英文、数字及常见字符。
您可以使用正斜线（/）快速创建子文件夹，但文件夹命名不能以正斜线（/）或反斜线（\）开头，且不能使用连续的正斜线（/）。
不能以 .. 作为文件夹名称。
待上传
通过选择或者拖拽方式，指定需要上传的本地文件或文件夹。
说明
同一存储桶中的文件不允许重名，如果您上传的文件与桶中已存在的文件重名，将按照如下策略处理：
存储桶未启用版本控制功能：上传文件会覆盖原有的同名文件。
存储桶开启了版本控制功能：上传文件会成为最新版本，已有同名文件会成为历史版本。关于版本控制的更多信息，请参见版本控制。
高级设置
存储类型
展开高级设置，设置文件的存储类型，文件存储类型默认继承桶的存储类型。不同存储类型说明如下：
继承存储桶：默认值，与桶的存储类型保持一致。
标准存储：高可用、高可靠、高性能存储类型，适用于频繁被访问的数据。
智能分层：适用于访问模式不固定的数据，需要收取对象监控费用。关于智能分层存储类型的详细信息，请参见智能分层。
低频存储：适用于频繁被访问的数据，最少存储 30 天。
归档闪回：适用于基本不会被访问的数据，最少存储 90 天。
归档：适用于基本不访问且需要长期保存的数据，最少存储 90 天。访问归档数据前需要先恢复数据。
冷归档： 适用于数据长期存储、基本不访问且访问可接受有一定响应时间的数据，最少存储 180 天。访问冷归档数据前需要先恢复数据。
深度冷归档：适用于需要超长时间存放的极冷数据，最少存储 180 天。访问深度冷归档数据前需要先恢复数据。
说明
当前仅华北2（北京）、华东2（上海）和华南1（广州）支持冷归档存储。
当前仅华北2（北京）、华东2（上海）和华南1（广州）支持深度冷归档，且都处于邀测状态，如您需要使用该存储类型，请联系客户经理。
关于存储类型的详细说明，请参见存储类型。
当存储桶开启多 AZ 冗余时，文件的存储类型将仅支持继承存储桶、标准存储（多 AZ）、智能分层（多 AZ）、低频存储（多 AZ）、归档闪回（多 AZ）。关于多 AZ 的详细介绍，请参见多 AZ 冗余。
服务端加密
展开高级设置，设置服务端加密方式。不同加密方式说明如下：
继承桶加密配置： 默认值，与存储桶的服务端加密方式保持一致。您可以在存储桶的概览页面基本信息区域，查看存储桶的服务端加密方式。您也可以修改存储桶的服务端加密方式，具体操作，请参见设置桶的服务端加密。
无：不加密。
SSE-TOS：TOS 托管密钥方式，是指文件上传后 TOS 对文件自动加密落盘存储，下载时自动解密，密钥由 TOS 托管，更多信息，请参见服务端加密。
SSE-KMS：使用火山引擎 KMS 托管的密钥对文件进行加解密，更多信息，请参见服务端加密。
说明
仅华北2（北京）、华东2（上海）、亚太东南（柔佛）和亚太东南（雅加达）地域支持 SSE-TOS 和 SSE-KMS。
仅支持在上传文件时设置服务端加密，上传后的文件不支持修改服务端加密。
首次使用 SSE-KMS 进行服务端加密，您需要开通 KMS 服务。开通 KMS 服务免费，使用 KMS 服务会收费。使用 SSE-KMS 进行服务端加密会产生 API 调用费用，创建 KMS 密钥会产生密钥托管费用，API 调用费用和密钥托管费用由 KMS 收取，更多信息，请参见 KMS 计费说明。
加密算法
展开高级设置，选择密钥的加密算法， 可选 AES256 和 SM4 算法。
说明
仅服务端加密选择 SSE-KMS 或 SSE-TOS 时，展示加密算法参数。
仅华北2（北京）、华东2（上海）、亚太东南（柔佛）和亚太东南（雅加达）地域支持 AES-256 算法；仅华北2（北京）、华东2（上海）支持 SM4 算法。
加密密钥类型
展开高级设置，默认为自定义密钥。
说明
仅服务端加密选择 SSE-KMS 时，展示加密密钥类型参数。
自定义密钥
展开高级设置，选择在 KMS 服务创建的密钥。如果您未创建密钥，您可以前往 KMS 服务创建密钥。具体操作，请参见 KMS 快速入门。
说明
仅服务端加密选择 SSE-KMS 时，需要设置自定义密钥参数。
元数据
展开高级设置，单击添加字段可设置对象元数据信息。TOS 支持设置的对象元数据详细说明，请参见管理对象元数据。
访问权限
设置对象的 ACL 策略，说明如下：
继承桶：对象将继承桶 ACL ，即对象的 ACL 策略将和桶 ACL 策略保持一致。关于对象 ACL 和桶 ACL 的对应关系，请参见对象继承桶 ACL。
说明
您还可以开启默认继承桶 ACL 功能，开启后，新上传的对象的 ACL 策略默认将和桶 ACL 策略保持一致。具体操作，请参见开启默认继承桶 ACL 。
私有：默认值，只有该对象的归属者及有授权的账号拥有读写权限，推荐使用。
公共读：任何用户对该对象都有读权限（包含匿名用户），但只有该对象的归属者及有授权的账号有写权限。
公共读写：任何用户对该对象都有读权限和写权限（包含匿名用户）。

说明
设置文件参数后，您可以在上传文件页面查看待上传的文件列表。
您可以单击目标文件操作列的移除，取消所选文件的上传；或单击文件列表上方的清空列表，取消所有文件的上传。
文件上传过程中，请勿刷新或关闭页面，否则上传任务会被中断且列表会被清空。
确定上传文件后，单击上传，即可开始上传文件。
单击上传后，页面自动跳转至任务进度管理面板。您也可以单击控制台右上方的任务中心，查看任务进度及状态。
其他操作
您可以在任务进度管理面板的上传任务页签，查看文件的上传进度及上传状态。您还可以在上传任务页签，执行以下操作：
取消上传：在文件列表，单击目标文件操作列的取消，即可取消上传该文件。
重新上传：取消上传文件或上传失败后，如果您需要重新上传，可以单击目标文件操作列的重试，TOS 会重新上传该文件。
清除上传记录：在文件列表，单击目标文件操作列的清除记录，即可清除文件的上传记录。删除文件记录并不会导致文件的删除。
复制链接：在文件列表，单击目标文件操作列的复制链接，即可复制上传文件的下载链接。
清除成功任务：单击文件列表左上方的清除成功任务，即可清除所有上传成功的文件记录。

对象/文件（Object）
对象是 TOS 存储数据的基本单元，本帮助文档中对象、文件、Object 均具有相同含义。对象由键（Key），数据（Data）和元数据（Metadata）三部分组成。
对象键（Key）是对象上传到存储桶后的完整名称，是包含目录、后缀的完整路径，如 abc/xyz/test123.txt。
对象的命名规范如下：
使用 UTF-8 编码。
长度必须在 1～1024 个字节之间。

您可以通过 TOS 控制台，将已上传到存储桶中的对象下载到本地（浏览器默认的下载路径）。

注意事项
下载文件时，文件大小不能超过 5GiB，如果您想要下载大文件，建议使用 TOS Browser 或 tosutil。
归档、冷归档和深度冷归档类型的文件需要先恢复为可读取状态，才能下载。

操作步骤
登录对象存储控制台。
单击左侧导航栏的桶列表，在桶列表页面单击目标桶名称。
在文件列表页面，单击指定文件操作列的下载，即可下载该文件。

访问域名
- 外网访问
Endpoint （地域节点）
tos-ap-southeast-1.volces.com
S3 endpoint
tos-s3-ap-southeast-1.volces.com
Bucket 域名
stt-small-01.tos-ap-southeast-1.volces.com
- 内网访问
Endpoint （地域节点）
tos-ap-southeast-1.ivolces.com
S3 endpoint
tos-s3-ap-southeast-1.ivolces.com
Bucket 域名
stt-small-01.tos-ap-southeast-1.ivolces.com

签名机制
在 Header 中携带签名时，签名的算法依赖于您上传对象时使用的传输方式。在对象存储 TOS 中，上传文件的传输方式主要分为单分块上传和多分块上传，适用于不同场景下的文件传输需求。
名词解释
名词
说明
校验和（CheckSum）
校验和是一种的数据完整性验证机制，用于检测数据在传输或存储过程中是否发生了错误或意外修改。其核心原理是通过对原始数据执行特定计算，生成一个简短的校验值（即校验和），接收方通过重新计算并比对校验和来判断数据是否被破坏。TOS 目前支持两种校验和：
基于 Md5 算法计算校验和，添加在 Header 的 Content-MD5 中。
基于 Sha256 算法计算校验和，添加在 Header 的 x-tos-content-sha256 中。
TOS V4 基础签名 Header
基于 TOS V4 签名算法计算出的签名，通过 Authorization 字段携带在 Header 中。详细计算方式见单分块上传的签名机制

单分块上传
单分块上传指使用单个分块传输全部有效数据的方式。
PUT /objectName HTTP/1.1
Host: bucketname.tos-cn-beijing.volces.com
Date: Fri, 30 Jul 2021 08:05:36 GMT
Authorization: authorization string
Content-Length: 12

hello world! 

在使用 TOS V4 基础签名进行单分块上传时，支持两种签名计算方式：带校验和的签名和不带校验和的签名。具体说明如下：
使用带校验和的签名
您可以将有效数据的校验和纳入到 V4 基础签名计算中，如果数据传输过程中内容或者校验和发生改变，签名校验将失败，从而保证数据传输过程中的安全。
但是为了提前获取有效数据的校验和，客户端通常需要先将全部数据读入内存以计算校验和，随后，还需要基于校验和进行签名计算，然后在发送数据时，第二次将数据读入内存进行传输，所以这可能会导致客户端性能降低。
若希望在确保数据完整性的同时避免客户端一次性加载所有数据进行校验和计算，推荐使用多分块上传方式。
使用不带校验和的签名
计算 TOS V4 基础签名时，不包含有效数据的校验和。这种方式在非 HTTPS 的场景下无法保证数据完整性，不推荐使用。
多分块上传
多分块上传指将有效数据拆分为多个固定长度或者可变长度的分块，然后分别进行上传的方式。
单个分块的数据组织形式如下：
string(IntHexBase(ChunkSize)) + ";chunk-signature=" + Signature + \r\n + ChunkData + \r\n

IntHexBase()：用于将整数转化为 16 进制数的函数。例如，若分块大小为 65536，则十六进制字符串为 10000。
ChunkSize：分块有效数据大小（不包含签名和格式数据）。例如，若上传一个 65KB 的对象，并且使用 64 KB 的固定分块大小，那么数据会被分割为三个分块：第一块为 64KB ，第二块为 1KB ，最后一个块为 0 字节。
Signature：分块的签名数据，当使用链式签名时才需设置。
ChunkData：分块有效数据。
在最后一个有效数据的分块后，需要再写一个包含 0 字节数据的分块，表示结束。基础的多分块数据格式如下：
PUT /objectName HTTP/1.1
Host: bucketname.tos-cn-beijing.volces.com
Date: Fri, 30 Jul 2021 08:05:36 GMT
Authorization: authorization string
Content-Encoding: tos-chunked
x-tos-content-sha256: STREAMING-UNSIGNED-PAYLOAD
x-tos-decoded-content-length: 12
Content-Length: 25

6
hello 
5
world
1
!
0

在对多分块上传进行签名时，TOS 支持以下签名计算方式：
只包含 TOS V4 基础签名
和单分块上传类似，在对多分块上传计算签名时，也可以选择是否在签名中携带校验和。如果选择带校验和的签名，客户端仍需要一次性读取所有数据计算校验和，存在额外的性能损耗。
包含 TOS V4 基础签名加链式签名
TOS V4 基础签名不携带校验和信息，但是在每个分块数据的开头，会包含分块的签名信息，签名内容包括请求参数、本分块有效数据的校验和以及上一个分块的签名信息。通过边传输边计算的方式，可以有效避免客户端一次性读取所有数据后再计算校验和导致的性能下降，也适用于未知长度的数据上传时，客户端无法提前计算全部数据的校验和，同时又需要保证数据传输安全性的场景。
多分块上传还支持使用 Trailing Header 的形式，在最后一个分块数据后，携带一份全部有效数据的校验和，用于服务端的数据完整性校验。Trailing Header 和链式签名作为两种不同的方式，都能有效保障传输过程中的安全性，建议用户上传时至少选择其中一种方式，或者两者同时使用。
在多分块上传时，需要指定 x-tos-content-sha256，用于标识上传格式，以及使用的签名方式。
x-tos-content-sha256 的取值
说明
有效数据的 sha256 值
表示 Header 中包含 TOS V4 基础签名，且 V4 基础签名中包含有效数据的校验和。除此之外，不包含链式签名和 Trailing Header。
STREAMING-TOS4-HMAC-SHA256-PAYLOAD
表示 Header 中包含 TOS V4 基础签名，数据中包含基于 HMAC-SHA256 计算的链式签名，数据末尾不包含 Trailing Header。
STREAMING-TOS4-HMAC-SHA256-PAYLOAD-TRAILER
表示 Header 中包含 TOS V4 基础签名，数据中包含基于 HMAC-SHA256 计算的链式签名，数据末尾包含 Trailing Header。
STREAMING-UNSIGNED-PAYLOAD-TRAILER
表示 Header 中包含 TOS V4 基础签名，数据中不包含链式签名，数据末尾包含 Trailing Header。
STREAMING-UNSIGNED-PAYLOAD
表示 Header 中包含 TOS V4 基础签名，数据中不包含链式签名，数据末尾不包含 Trailing Header。

说明
多分块上传可以和 Transfer-Encoding: chunked 同时使用，若使用 Transfer-Encoding: chunked，则无需携带 Content-Length 头域。
多分块上传请求示例
不使用链式签名和 Trailing Header
PUT /objectName HTTP/1.1
Host: bucketname.tos-cn-beijing.volces.com
Date: Fri, 30 Jul 2021 08:05:36 GMT
Authorization: authorization string
Content-Encoding: tos-chunked
x-tos-content-sha256: STREAMING-UNSIGNED-PAYLOAD
x-tos-decoded-content-length: 12
Content-Length: 25

6
hello 
5
world
1
!
0

使用链式签名，不使用 Trailing Header。
PUT /objectName HTTP/1.1
Host: bucketname.tos-cn-beijing.volces.com
Date: Fri, 30 Jul 2021 08:05:36 GMT
Authorization: authorization string
Content-Encoding: tos-chunked
x-tos-content-sha256: STREAMING-TOS4-HMAC-SHA256-PAYLOAD
x-tos-decoded-content-length: 12
Content-Length: 342

6;chunk-signature=b474d8862b1487a5145d686f57f013e54db672cee1c953b3010fb58501ef5aa2
hello
5;chunk-signature=1a7e8d3c0f9b2a5e4d6c7b8a9f0e1d2c3b4a5d6e7f8091a2b3c4d5e6f7a8b9
world
1;chunk-signature=f42e5c8a3b7d6091e2a4f8c5d7b3a0e6f1c9d2a8b7e4f5c6d3e8a9b0c1d2e3
!
0;chunk-signature=b6c6ea8a5354eaf15b3cb7646744f4275b71ea724fed81ceb9323e279d449df9

不使用链式签名，使用 Trailing Header
PUT /objectName HTTP/1.1
Host: bucketname.tos-cn-beijing.volces.com
Date: Fri, 30 Jul 2021 08:05:36 GMT
Authorization: authorization string
Content-Encoding: tos-chunked
x-tos-content-sha256: STREAMING-UNSIGNED-PAYLOAD-TRAILER
x-tos-decoded-content-length: 12
Content-Length: 56
x-tos-trailer: x-tos-hash-crc64ecma

6
hello
5
world
1
!
0
x-tos-hash-crc64ecma:smtwW8C72Y8=

同时使用链式签名和 Trailing Header
PUT /objectName HTTP/1.1
Host: bucketname.tos-cn-beijing.volces.com
Date: Fri, 30 Jul 2021 08:05:36 GMT
Authorization: authorization string
Content-Encoding: tos-chunked
x-tos-content-sha256: STREAMING-AWS4-HMAC-SHA256-PAYLOAD-TRAILER
x-tos-trailer: x-tos-hash-crc64ecma
x-tos-decoded-content-length: 12
Content-Length: 464

6;chunk-signature=b474d8862b1487a5145d686f57f013e54db672cee1c953b3010fb58501ef5aa2
hello
5;chunk-signature=1a7e8d3c0f9b2a5e4d6c7b8a9f0e1d2c3b4a5d6e7f8091a2b3c4d5e6f7a8b9
world
1;chunk-signature=f42e5c8a3b7d6091e2a4f8c5d7b3a0e6f1c9d2a8b7e4f5c6d3e8a9b0c1d2e3
!
0;chunk-signature=b6c6ea8a5354eaf15b3cb7646744f4275b71ea724fed81ceb9323e279d449df9
x-tos-hash-crc64ecma:smtwW8C72Y8=
x-tos-trailer-signature:41e14ac611e27a8bb3d66c3bad6856f209297767d5dd4fc87d8fa9e422e03faf

签名方式
单分块上传的签名机制
多分块上传的签名机制
多分块上传的 Trailing Header


# PutObject
功能描述
此接口用于向桶中添加对象。要向桶中添加对象，必须对桶具有写权限。
TOS 是一个分布式系统。如果它同时收到针对同一对象的多个写请求，它将覆盖除最后一个写入对象以外的所有写请求。可以使用Content-MD5头带入期望的 MD5 值，与上传的对象的 MD5 值进行比较，如果不相等，则返回错误。
服务端加密
如果您使用服务端加密，TOS 在收到您上传的数据时，在文件级别加密这些数据，再将加密的数据持久化存储；您下载文件时，TOS 自动将加密数据解密后返回给您。关于服务端加密的更多详细信息，请参见服务端加密概述。
ACL
您可以通过 headers 去设置对象的 ACL。所有的对象默认是私有的。您可以给某个账号或者预定义组授予对应的权限。关于 ACL 的更多详细信息，请参见 ACL 策略概述。
存储类型
TOS 默认使用标准存储类型存储对象。标准存储类型是高可用、高可靠、高性能的存储类型。您也可以根据不同的使用场景，选择不同的存储类型。关于存储类型的更多详细信息，请参见存储类型。
多版本
如果桶已开启多版本，新上传对象时会为对象自动生成一个唯一版本号，并在响应消息中通过头域 x-tos-version-id 带回版本号。
如果桶暂停了多版本，新上传对象的版本号为 null，并且暂停后重复上传只会保留最新上传的对象。
请求消息样式
PUT /objectName HTTP/1.1
Host: bucketname.tos-cn-beijing.volces.com
Date: GMT Date
Authorization: authorization string
Content-length: length

<put data>

请求参数和消息头
该请求使用的公共请求消息头，请参见公共参数。
名称
位置
参数类型
是否必选
示例值
说明
Content-Length
Header
Integer
是
100
消息体的大小。
Content-MD5
Header
String
否
XrY7u+Ae7tCTyyK7j1rNww==
消息体的 Base64MD5 摘要。
Content-Type
Header
String
否
text/plain
对象类型。
Cache-Control
Header
String
否
no-cache, no-store, must-revalidate
指定该对象被下载时网页的缓存行为。
Expires
Header
String
否
Mon, 04 Jul 2022 02:57:31 GMT
RFC2616 中定义的缓存失效时间。
Content-Disposition
Header
String
否
attachment; filename=123.txt
对象被下载时的名称。
Content-Encoding
Header
String
否
gzip
对象被下载时的内容编码类型。
Content-Language
Header
String
否
en-US
对象被下载时的内容语言格式。
x-tos-acl
Header
String
否
private
对象的访问权限，有效的权限设置包括：
private：私有的。
public-read：公共读。
public-read-write：公共读写。
authenticated-read：认证用户读。
bucket-owner-read ：桶所有者读。
bucket-owner-full-control：桶所有者完全权限。
bucket-owner-entrusted：受桶策略控制，桶所有者完全权限。
default：继承桶 ACL，即对象的 ACL 策略和桶 ACL 策略保持一致。
x-tos-grant-full-control
Header
String
否
id=123,id=456
创建对象时，使用此头域授权用户具有对象的读（READ）、读（READ） ACP、写（WRITE） ACP 的权限。格式：id=账号1,id=账号2。
x-tos-grant-read
Header
String
否
id=123,id=456
允许被授权者读取对象和对象元数据的权限。格式：id=账号1,id=账号2。
x-tos-grant-read-acp
Header
String
否
id=123,id=456
允许被授权者读取对象 ACL。格式：id=账号1,id=账号2。
x-tos-grant-write-acp
Header
String
否
id=123,id=456
允许被授权者修改对象 ACL。格式：id=账号1,id=账号2。
x-tos-meta-*
Header
String
否
x-tos-meta-key: value
创建对象时，可以在 HTTP 请求中加入以 x-tos-meta-开头的消息头，用来加入自定义的元数据，以便对对象进行自定义管理。当用户获取此对象或查询此对象元数据时，加入的自定义元数据将会在返回消息的头中出现。
x-tos-server-side-encryption
Header
String
否
AES256
设置目标对象的加密方式，如果未设置，默认为非加密对象，取值说明如下：
AES256：使用 SSE-TOS 加密方式，并采用 AES256 加密算法。
SM4：使用 SSE-TOS 加密方式，并采用 SM4 加密算法。
kms: 使用 SSE-KMS 加密方式。
关于 SSE-TOS、 SSE-KMS 加密方式详细说明，请参见服务端加密概述。
说明
使用 SSE-KMS 进行服务端加密会产生 API 调用费用，创建 KMS 密钥会产生密钥托管费用，由 KMS 收取，更多信息，请参见 KMS 计费说明。
x-tos-server-side-data-encryption
Header
String
否
AES256
使用 SSE-KMS 加密方式时的加密算法，取值说明如下：
AES256： AES256 加密算法。
SM4: SM4 加密算法。
默认为 AES256 算法。
x-tos-server-side-encryption-kms-key-id
Header
String
否，使用 SSE-KMS 加密时，必选。
trn:kms:cn-beijing:20000111:keyrings/ring-test/keys/key-test
指定 SSE-KMS 加密目标对象使用的主密钥，格式如下：
trn:kms:<region>:<accountID>:keyrings/<keyring>/keys/<key>：KMS 主密钥的 TRN，其中 region 为使用密钥所属 Region ID，accountID 为密钥所属账号的 ID，keyring 为密钥环别名，key 为主密钥别名。
说明
目前不支持默认主密钥，如果指定 SSE-KMS 加密而没有提供该头域，服务端会返回 400 InvalidRequest 错误。
x-tos-server-side-encryption-customer-algorithm
Header
String
否，使用 SSE-C 加密时，必选。
AES256
指定 SSE-C 加密对象要使用的算法，取值说明如下：
AES256：使用 AES256 算法加密对象。
x-tos-server-side-encryption-customer-key
Header
String
否，使用 SSE-C 加密时，必选。
YWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWE=
与 x-tos-server-side-encryption-customer-algorithm 配套使用，指定 SSE-C 加密目标对象的密钥，格式为 base64 编码的 256 bit 的加密密钥。
x-tos-server-side-encryption-customer-key-MD5
Header
String
否，使用 SSE-C 加密时，必选。
0gYVWExOAz67jX5A6qY4+A==
与 x-tos-server-side-encryption-customer-key 配套使用，该头域表示加密对象使用的密钥的MD5值。该头域由密钥的 128-bit MD5 值经过 base64-encoded 得到，该值用于消息完整性检查，确认加密密钥在传输过程中没有出错。
x-tos-website-redirect-location
Header
String
否
/anotherObjectName
当桶设置了 Website 配置，可以将获取这个对象的请求重定向到桶内另一个对象或一个外部的 URL，TOS 将这个值从头域中取出，保存在对象的元数据中。
x-tos-storage-class
Header
String
否
STANDARD
设置目的对象的存储类型。如果未设置，则目的对象的存储类型，和所在桶的默认存储类型保持一致，取值说明如下：
STANDARD：标准存储。
IA：低频访问存储。
INTELLIGENT_TIERING：智能分层存储。
ARCHIVE_FR：归档闪回存储。
ARCHIVE：归档存储。
COLD_ARCHIVE：冷归档存储。
DEEP_COLD_ARCHIVE：深度冷归档存储。
说明
当前仅华北2（北京）、华东2（上海）和华南1（广州）支持冷归档存储。
当前仅华北2（北京）、华东2（上海）和华南1（广州）支持深度冷归档存储，且都处于邀测状态，如您需要使用该存储类型，请联系客户经理。
x-tos-tagging
Header
String
否
Key1=Value1&Key2=Value2
设置对象的标签信息， 格式为 {Key}={Value}，支持同时设置多个标签，设置多个标签时使用 & 分隔。
说明
对象标签的 Key 和 Value 需要先进行 URL 编码。
如果某个对象未使用 = 设置 Value，则 TOS 会认为该标签的 Value 为空字符串。
关于对象标签的更多限制信息，请参见对象标签。
x-tos-traffic-limit
Header
String
否
819200
TOS 提供单链接限速功能，在上传、下载文件等操作中进行流控控制，以保证其他应用的网络带宽。取值说明如下：
取值范围：245760-838860800，单位为 bit/s。
Header 和 Query 中不能同时存在此参数。
x-tos-forbid-overwrite
Header
String
否
false
是否允许覆盖同名 Object，取值说明如下：
不指定或者指定为 false ：表示允许覆盖同名 Object。
指定为 true 时：表示禁止覆盖同名 Object。
注意
当目标 Bucket 处于已开启或已暂停的版本控制状态时，x-tos-forbid-overwrite 参数设置无效，即允许覆盖同名 Object。
x-tos-traffic-limit
Query
String
否
819200
TOS 提供单链接限速功能，在上传、下载文件等操作中进行流控控制，以保证其他应用的网络带宽。取值说明如下：
取值范围：245760-838860800，单位为 bit/s。
Header 和Query 中不能同时存在此参数。
x-tos-object-expires
Header
String
否
3
设置对象的过期时间，过期后，TOS 将自动删除对象。单位为天，支持设置为正整数，表示对象将在指定时间过期，从对象的 Last‑Modified 时间开始计算，在到达该过期时间后的零点开始执行删除任务。
例如设置 x-tos-object-expires 参数的值为 3，对象的 Last‑Modified 时间为 2024-09-26 12:00，则该对象将于 2024-09-30 00:00 过期。
说明
对象过期时间优先级高于生命周期的删除规则，例如设置对象过期时间为 5 天，生命周期规则指定该对象 3 天后删除，最终将按照对象过期时间执行，即对象将于 5 天后被删除。
TOS 支持通过 GetObject或 HeadObject 查询对象的过期时间。
x-tos-object-lock-mode
Header
String
否
COMPLIANCE
保留策略的模式，取值仅为 COMPLIANCE，表示合规模式。
说明
为对象设置保留策略时，您需要先开启保留策略功能，详细介绍，请参见PutBucketObjectLockConfiguration。
x-tos-object-lock-retain-until-date
Header
String
否
2025-01-01T00:00:00Z
对象被锁定的截止日期，在该日期内，对象不能被删除或覆盖。遵循 ISO 8601 时间格式。
说明
x-tos-object-lock-retain-until-date 参数需要和 x-tos-object-lock-mode 参数一起使用。
if-match
Header
String
否
d41d8cd98f00b204e9800998ecf8427e
控制上传行为的 ETag 条件，只有当指定的 ETag 与存储桶中已有对象的 ETag 匹配时，才会上传对象。若指定的 ETag 不存在或不匹配，则上传对象会失败，并返回 412 状态码。
if-none-match
Header
String
否
d41d8cd98f00b204e9800998ecf8427e
控制上传行为的 ETag 条件，只有当指定的 ETag 与存储桶中已有对象的 ETag 不匹配时，才会上传对象。若存储桶中已有对象的 ETag 匹配指定的 ETag，则上传对象会失败，并返回 412 状态码。
说明
if-none-match 支持设置为 *，表示只要目标存储桶中存在同名对象（无论其 ETag 是什么），上传就会失败，并返回 412 状态码。

请求元素
该请求中无请求消息元素，请求体中带的是上传对象的数据内容。
响应消息头
该请求返回的公共响应消息头，请参见公共参数。
名称
参数类型
示例值
说明
x-tos-server-side-encryption
String
kms
对象是 SSE-TOS 加密或 SSE-KMS 时返回该头域，该头域表示对象的服务端加密方式，取值如下：
AES256：使用 SSE-TOS 加密方式，并采用 AES256 加密算法。
SM4：使用 SSE-TOS 加密方式，并采用 SM4 加密算法。
kms: 使用 SSE-KMS 加密方式。
关于 SSE-TOS、 SSE-KMS 加密方式详细说明，请参见服务端加密概述。
x-tos-server-side-encryption-kms-key-id
String
trn:kms:cn-beijing:****:keyrings/ring-test/keys/key-test
对象采用 SSE-KMS 加密方式时返回该头域，该头域表示 SSE-KMS 加密使用的 KMS 主密钥 ID。
x-tos-server-side-encryption-customer-algorithm
String
AES256
对象是 SSE-C 加密时返回此头域，确认使用的加密算法。
x-tos-server-side-encryption-customer-key-MD5
String
0gYVWExOAz67jX5A6qY4+A==
对象是 SSE-C 加密时返回此头域，该头域表示加密使用的密钥的 MD5 值。
x-tos-version-id
String
57AF1A32CECB56721267
对象的版本号。如果不存在版本号，则该消息头不会出现在响应消息中。
x-tos-hash-crc64ecma
Integer
6186290338114851376
表示该对象的 64 位 CRC 值。该 64 位 CRC 根据 ECMA-182 标准计算得出。
说明
当上传对象使用服务端加密时，该值为对象明文内容的 CRC64 校验值。
x-tos-qos-delay-time
Integer
10
该头域表示请求被流控时长，单位为ms。上传类请求会返回精确的被流控的时长；copy类请求或者下载类请求会返回根据流控程度和文件大小估算出的被流控的时长。

响应元素
该请求响应中无消息元素。
请求示例
PUT /objectName HTTP/1.1
Host: bucketname.tos-cn-beijing.volces.com
Date: Fri, 30 Jul 2021 08:05:36 GMT
Authorization: authorization string
Content-Length: 100

[100 Byte data content]

响应示例
HTTP/1.1 200 OK
x-tos-id-2: 367be10900210004-a444ed0
x-tos-request-id: 367be10900210004-a444ed0
Date: Fri, 30 Jul 2021 08:05:36 GMT
server: TosServer
Content-Length: 0
ETag: "1c06e540e11d65a51aeb724e72fa641a"
x-tos-hash-crc64ecma: 6186290338114851376


# PostObject
功能描述
此接口可以将本地不超过 5GiB 的对象以HTML表单的形式上传至指定存储桶中。此接口的请求者需要对存储桶有写权限。
注意事项
表单数据和边界的大小（不包括 file 内容）不能超过 20KiB。
表单域中没有 policy 的请求被认为是匿名的，并且只能在可公开写入的存储桶上成功。
构建请求时，请确保该 file 字段是表单中的最后一个字段（ file 后的字段将忽略）。
上传的对象的大小不能超过 5GiB。
请求消息样式
POST / HTTP/1.1
Host: buketname.tos-cn-beijing.volces.com
Accept-Encoding: encoding
Accept-Charset: character_set
Keep-Alive: 300
Connection: keep-alive
Content-Type: multipart/form-data; boundary=9431149156168
Content-Length: length
--9431149156168
Content-Disposition: form-data; name="key"
objectname
--9431149156168
Content-Disposition: form-data; name="success_action_redirect"
success_redirect
--9431149156168
Content-Disposition: form-data; name="x-tos-meta-uuid"
uuid
--9431149156168
Content-Disposition: form-data; name="x-tos-meta-tag"
metadata
--9431149156168
Content-Disposition: form-data; name="Content-Disposition"
attachment;filename=download.jpg
--9431149156168
Content-Disposition: form-data; name="x-tos-algorithm"
TOS4-HMAC-SHA256
--9431149156168
Content-Disposition: form-data; name="x-tos-date"
20220411T000000Z
--9431149156168
Content-Disposition: form-data; name="x-tos-credential"
<your-access-key-id>/<date>/<region>/<service>/request
--9431149156168
Content-Disposition: form-data; name="policy"
encoded_policy
--9431149156168
Content-Disposition: form-data; name="x-tos-signature"
signature
--9431149156168
Content-Disposition: form-data; name="file"; filename="MyFilename.jpg"
Content-Type: image/jpeg
file_content
--9431149156168
Content-Disposition: form-data; name="submit"
Upload to TOS
--9431149156168--

请求参数和消息头
该操作的实现不使用请求参数。
请求元素
名称
参数类型
是否必选
示例值
说明
policy
String
是，有条件
eyJleHBpcmF0aW9uIjoiMjAyMi0wMS0wNVQwMDowMDowM C4wMDBaIiwiY29uZGl0aW9ucyI6W3siYnVja2V0IjoiZXhhbXB sZWJ1Y2tldCJ9LFsic3RhcnRzLXdpdGgiLCIka2V5IiwiZXhhbX BsZSJdXX0=
Base64 编码的安全策略，描述请求中允许的内容。
默认值：无
注意
如果存储桶不允许公开写入，则需要携带 policy，携带了 policy，必须携带签名相关表单字段。
x-tos-algorithm
String
是，有条件
TOS4-HMAC-SHA256
该参数表明使用的签名算法。对于 TOS，该值为 TOS4-HMAC-SHA256。
注意
如果该请求包含了安全策略 policy 参数时，则必须提供此参数。
x-tos-credential
String
是，有条件
testAK/20220101/cn-beijing/tos/request
除了您的访问密钥 ID之外，这还提供了您在计算签名密钥以进行签名计算时使用的范围信息。
格式为 <your-access-key-id>/<date>/<region>/tos/request。
注意
如果该请求包含了安全策略 policy 参数时，则必须提供此参数。
x-tos-date
String
是，有条件
20220101T000000Z
ISO8601 格式的日期值。例如，20130728T000000Z。 与在创建签名密钥时使用的日期相同，也必须是 policy 中指定的 x-tos-date 相同的值。
注意
如果该请求包含了安全策略 policy 参数时，则必须提供此参数。
x-tos-signature
String
是，有条件
94d72cb3bbd094f6d8eaa0b7e56905500029813febc9fee352474f88d093c3e5
基于安全策略 policy 和 SigningKey 计算的 HMAC-SHA256 哈希值。
注意
如果该请求包含了安全策略policy参数时，则必须提供此参数。
x-tos-acl
String
否
public-read
在文件表单域中指定Object的访问权限。
默认值：private
有效值：private
x-tos-tagging
String
否
{ "TagSet": { "Tags": [{ "Key": "Tag1", "Value": "Tag1" }, { "Key": "Tag2", "Value": "Tag2" }] } }
要添加到对象的指定标签集合。
默认值：无
key
String
是
exampleobject
要上传对象的名称。
file
File
是
test
文件或文本内容，无需编码。浏览器会自动根据文件类型来设置 Content-Type，并覆盖您的设置。TOS 一次只能上传一个文件。
注意
构建请求时，请确保该 file 字段是表单中的最后一个字段（file 后的字段将忽略）。
Cache-Control
String
否
no-cache
HTTP 标准头域，详细信息，请参见 RFC 2616。
默认值：无
Content-Type
String
否
image/jpeg
HTTP 标准头域，详细信息，请参见 RFC 2616。
默认值：无
Content-Disposition
String
否
form-data; name="key"
HTTP 标准头域，详细信息，请参见 RFC 2616。
默认值：无
Content-Encoding
String
否
gzip
HTTP 标准头域，详细信息，请参见 RFC 2616。
默认值：无
Content-Language
String
否
en-US
HTTP 标准头域，详细信息，请参见 RFC 2616。
默认值：无
Content-MD5
String
否
XrY7u+Ae7tCTyyK7j1rNww==
消息体的 Base64MD5 摘要。
Expires
String
否
Wed, 18 Jul 2024 18:00:00 GMT
HTTP 标准头域，详细信息，请参见 RFC 2616。
默认值：无
success_action_redirect
String
否
http://examplebucket.tos-cn-beijing.volces.com/successful_upload.html
上传成功后客户端跳转到的 URL。如果未指定该表单域，返回结果由 success_action_status 表单域指定。如果上传失败，返回错误码，并不进行跳转。
默认值：无
success_action_status
Integer
否
201
未指定 success_action_redirect 表单域时，该表单域指定了上传成功后返回给客户端的状态码。
默认值：204
有效值：200、201、204
说明
如果该域的值设置为 200 或者 204，TOS 返回一个空文档和相应的状态码。
如果该域的值设置为 201，TOS 返回一个 JSON 内容和 201 状态码。如果该域的值未设置或者设置为一个非法值，TOS 返回一个空文档和 204 状态码。
x-tos-storage-class
String
否
STANDARD
设置对象的存储类型。如果未设置，则和桶的默认存储类型保持一致。
默认值：无
有效值如下：
STANDARD：标准存储。
IA：低频访问存储。
INTELLIGENT_TIERING：智能分层存储。
ARCHIVE_FR：归档闪回存储。
ARCHIVE：归档存储。
COLD_ARCHIVE：冷归档存储。
DEEP_COLD_ARCHIVE：深度冷归档存储。
说明
当前仅华北2（北京）、华东2（上海）和华南1（广州）支持冷归档存储。
当前仅华北2（北京）、华东2（上海）和华南1（广州）支持深度冷归档存储，且都处于邀测状态，如您需要使用该存储类型，请联系客户经理。
x-tos-meta-*
String
否
x-tos-meta-tag:image
您指定的 user meta 值。
默认值：无
说明
如果请求中携带以 x-tos-meta- 为前缀的表单域，则视为 user meta，例如 x-tos-meta-location。
x-tos-security-token
String
否
STSeyJBY2NvdW50SWQiOjIxMDAwMDUyMjQsIklkZW50aXR5VHlwZSI6NCwiSWRlbnRpdHlJZCI6MTE3MjI5NiwiQ2hhbm5lbCI6IlVzZXIiLCJBY2Nlc3NLZXlJZCI6IkFLVFBZbUkxWkdRd01EQTBOamxoTkdGa016aGpOek0wTjJRME9UU****
如果本次访问是使用 STS 临时授权方式，则需要指定该项为 SecurityToken 的值，同时 AccessKeyId 需要使用与之配对的临时 AccessKey Id。
默认值：无
x-tos-website-redirect-location
String
否
/anotherPage.html
当桶设置了 Website 配置，可以将获取这个对象的请求重定向到桶内另一个对象或一个外部的 URL，TOS 将这个值从头域中取出，保存在对象的元数据中。
默认值：无
x-tos-server-side-encryption
String
否
AES256
设置目标对象的加密方式，如果未设置，默认为非加密对象，取值说明如下：
AES256：使用 SSE-TOS 加密方式，并采用 AES256 加密算法。
SM4：使用 SSE-TOS 加密方式，并采用 SM4 加密算法。
kms: 使用 SSE-KMS 加密方式。
关于 SSE-TOS、 SSE-KMS 加密方式详细说明，请参见服务端加密概述。
说明
使用 SSE-KMS 进行服务端加密会产生 API 调用费用，创建 KMS 密钥会产生密钥托管费用，由 KMS 收取，更多信息，请参见 KMS 计费说明。
x-tos-server-side-data-encryption
String
否
AES256
使用 SSE-KMS 加密方式时的加密算法，取值说明如下：
AES256： AES256 加密算法。
SM4: SM4 加密算法。
默认为 AES256 算法。
x-tos-server-side-encryption-kms-key-id
String
否，使用 SSE-KMS 加密时，必选。
trn:kms:cn-beijing:20000111:keyrings/ring-test/keys/key-test
指定 SSE-KMS 加密目标对象使用的主密钥，格式如下：
trn:kms:<region>:<accountID>:keyrings/<keyring>/keys/<key>：KMS 主密钥的 TRN，其中 region 为使用密钥所属 Region ID，accountID 为密钥所属账号的 ID，keyring 为密钥环别名，key 为主密钥别名。
说明
目前不支持默认主密钥，如果指定 SSE-KMS 加密而没有提供该头域，服务端会返回 400 InvalidRequest 错误。
x-tos-server-side-encryption-customer-algorithm
String
否，使用 SSE-C 加密时，必选。
AES256
指定 SSE-C 加密对象要使用的算法，取值说明如下：
AES256：使用 AES256 算法加密对象。
x-tos-server-side-encryption-customer-key
String
否，使用 SSE-C 加密时，必选。
YWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWE=
与 x-tos-server-side-encryption-customer-algorithm 配套使用，指定 SSE-C 加密目标对象的密钥，格式为 base64 编码的 256 bit 的加密密钥。
x-tos-server-side-encryption-customer-key-MD5
String
否，使用 SSE-C 加密时，必选。
ACdH+Fu9K3HlXdIUBu8GdA==
与 x-tos-server-side-encryption-customer-key 配套使用，该元素表示加密对象使用的密钥的MD5值。该元素由密钥的 128-bit MD5 值经过 base64-encoded 得到，该值用于消息完整性检查，确认加密密钥在传输过程中没有出错。
x-tos-traffic-limit
String
否
819200
TOS 提供单链接限速功能，在上传、下载文件等操作中进行流控控制，以保证其他应用的网络带宽。取值说明如下：
取值范围：245760-838860800，单位为 bit/s。
x-tos-forbid-overwrite
String
否
false
是否允许覆盖同名 Object，取值说明如下：
不指定或者指定为 false ：表示允许覆盖同名 Object。
指定为 true 时：表示禁止覆盖同名 Object。
说明
当目标 Bucket 处于已开启或已暂停的版本控制状态时，x-tos-forbid-overwrite 参数设置无效，即允许覆盖同名 Object。
x-tos-object-expires
String
否
3
设置对象的过期时间，过期后，TOS 将自动删除对象。单位为天，支持设置为正整数，表示对象将在指定时间过期，从对象的 Last‑Modified 时间开始计算，在到达该过期时间后的零点开始执行删除任务。
例如设置 x-tos-object-expires 参数的值为 3，对象的 Last‑Modified 时间为 2024-09-26 12:00，则该对象将于 2024-09-30 00:00 过期。
说明
对象过期时间优先级高于生命周期的删除规则，例如设置对象过期时间为 5 天，生命周期规则指定该对象 3 天后删除，最终将按照对象过期时间执行，即对象将于 5 天后被删除。
TOS 支持通过 GetObject或 HeadObject 查询对象的过期时间。
x-tos-object-lock-mode
String
否
COMPLIANCE
保留策略的模式，取值仅为 COMPLIANCE，表示合规模式。
说明
为对象设置保留策略时，您需要先开启保留策略功能，详细介绍，请参见PutBucketObjectLockConfiguration。
x-tos-object-lock-retain-until-date
String
否
2025-01-01T00:00:00Z
对象被锁定的截止日期，在该日期内，对象不能被删除或覆盖。遵循 ISO 8601 时间格式。
说明
x-tos-object-lock-retain-until-date 参数需要和 x-tos-object-lock-mode 参数一起使用。

响应消息头
该请求返回的公共响应消息头，请参见公共参数。
名称
参数类型
示例值
说明
x-tos-server-side-encryption
String
AES256
对象是 SSE-TOS 加密或 SSE-KMS 时返回该头域，该头域表示对象的服务端加密方式，取值如下：
AES256：使用 SSE-TOS 加密方式，并采用 AES256 加密算法。
SM4：使用 SSE-TOS 加密方式，并采用 SM4 加密算法。
kms: 使用 SSE-KMS 加密方式。
关于 SSE-TOS、 SSE-KMS 加密方式详细说明，请参见服务端加密概述。
x-tos-server-side-encryption-kms-key-id
String
trn:kms:cn-beijing:20000111:keyrings/ring-test/keys/key-test
对象采用 SSE-KMS 加密方式时返回该头域，该头域表示 SSE-KMS 加密使用的 KMS 主密钥 ID。
x-tos-server-side-encryption-customer-algorithm
String
YWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWE=
对象是 SSE-C 加密时返回此头域，确认使用的加密算法。
x-tos-server-side-encryption-customer-key-MD5
String
ACdH+Fu9K3HlXdIUBu8GdA==
对象是 SSE-C 加密时返回此头域，该头域表示加密使用的密钥的 MD5 值。
x-tos-version-id
String
19EA1B32CEEB56721221
对象的版本号。如果不存在版本号，则该消息头不会出现在响应消息中。
x-tos-hash-crc64ecma
Integer
6186290338114851376
表示该对象的 64 位 CRC 值。该 64 位 CRC 根据 ECMA-182 标准计算得出。
说明
当上传对象使用服务端加密时，该值为对象明文内容的 CRC64 校验值。
x-tos-qos-delay-time
Integer
10
该头域表示请求被流控时长，单位为ms。上传类请求会返回精确的被流控的时长；copy类请求或者下载类请求会返回根据流控程度和文件大小估算出的被流控的时长。

响应元素
当 success_action_status 的值设置为 201，TOS 会返回一个 JSON 内容。
名称
参数类型
示例值
说明
Bucket
String
examplebucket
存储对象的存储桶的名称。
Key
String
exampleobject
对象名称。
Location
String
https://buketname.tos-cn-beijing.volces.com/object
新创建对象的带域名的 URL。
ETag
String
"ab7abb0da4bca5323ab6119bb5dcd296"
在创建每个对象的时候生成，唯一标识一个对象的内容。
HashCrc64ecma
String
6186290338114851376
上传文件的 CRC64 值。

请求示例
POST / HTTP/1.1
Host: examplebucket.tos-cn-beijing.volces.com
Accept-Encoding: encoding
Accept-Charset: character_set
Keep-Alive: 300
Connection: keep-alive
Content-Type: multipart/form-data; boundary=9431149156168
Content-Length: length
--9431149156168
Content-Disposition: form-data; name="key"
exampleobject
--9431149156168
Content-Disposition: form-data; name="success_action_redirect"
http://examplebucket.tos-cn-beijing.volces.com/successful_upload.html
--9431149156168
Content-Disposition: form-data; name="x-tos-meta-tag"
metadata
--9431149156168
Content-Disposition: form-data; name="Content-Type"
image/jpg
--9431149156168
Content-Disposition: form-data; name="x-tos-server-side-encryption"
AES256
--9431149156168
Content-Disposition: form-data; name="x-tos-algorithm"
TOS4-HMAC-SHA256
--9431149156168
Content-Disposition: form-data; name="x-tos-date"
20220101T000000Z
--9431149156168
Content-Disposition: form-data; name="x-tos-credential"
testAK/20220101/cn-beijing/tos/request
--9431149156168
Content-Disposition: form-data; name="policy"
ewogICAgICAgICJleHBpcmF0aW9uIjogIjIwMjItMDEtMDVUMDA6MDA6MDAuMDAwWiIsCiAgICAgICAgImNvbmRpdGlvbnMiOiBbCiAgICAgICAgeyJidWNrZXQiOiAiZXhhbXBsZWJ1Y2tldCJ9LAogICAgICAgIFsic3RhcnRzLXdpdGgiLCAiJGtleSIsICJleGFtcGxlIl0sIAogICAgICAgIHsiYWNsIjogInB1YmxpYy1yZWFkIn0sIAogICAgICAgIHsic3VjY2Vzc19hY3Rpb25fcmVkaXJlY3QiOiAiaHR0cDovL2V4YW1wbGVidWNrZXQudG9zLWNuLWJlaWppbmcudm9sY2VzLmNvbS9zdWNjZXNzZnVsX3VwbG9hZC5odG1sIn0sCiAgICAgICAgWyJzdGFydHMtd2l0aCIsICIkQ29udGVudC1UeXBlIiwgImltYWdlLyJdLCAKICAgICAgICBbInN0YXJ0cy13aXRoIiwgIiR4LXRvcy1tZXRhLXRhZyIsICIiXSwgCiAgICAgICAgCiAgICAgICAgeyJ4LXRvcy1zZXJ2ZXItc2lkZS1lbmNyeXB0aW9uIjogIkFFUzI1NiJ9LCAKICAgICAgICB7IngtdG9zLWNyZWRlbnRpYWwiOiAidGVzdEFLLzIwMjIwMTAxL2NuLWJlaWppbmcvdG9zL3JlcXVlc3QifSwgCiAgICAgICAgeyJ4LXRvcy1hbGdvcml0aG0iOiAiVE9TNC1ITUFDLVNIQTI1NiJ9LCAKICAgICAgICB7IngtdG9zLWRhdGUiOiAiMjAyMjAxMDFUMDAwMDAwWiJ9CiAgICAgICAgXQp9
--9431149156168
Content-Disposition: form-data;f name="x-tos-signature"
94d72cb3bbd094f6d8eaa0b7e56905500029813febc9fee352474f88d093c3e5
--9431149156168
Content-Disposition: form-data; name="file"; filename="MyFile.jpg"
Content-Type: image/jpeg
file_content
--9431149156168
Content-Disposition: form-data; name="submit"
Upload to TOS
--9431149156168--

响应示例
HTTP/1.1 204 No Content
x-tos-id-2: 367be10900210004-a444ed0
x-tos-request-id: 367be10900210004-a444ed0
Date: Fri, 1 Jul 2022 01:00:36 GMT
Server: TosServer
Content-Length: 0
ETag: "ab7abb0da4bca5323ab6119bb5dcd296"
Location: http://examplebucket.tos-cn-beijing.volces.com/successful_upload.html
x-tos-hash-crc64ecma: 6186290338114851376


# GetObject
功能描述
此接口用于从桶中下载指定对象。桶的拥有者或者被授权的用户才具有调用此接口下载对象的权限。多版本状态下，如果未指定版本号，下载当前版本的对象，如果指定versionId，则返回指定版本的对象。
服务端加密
如果要下载的对象使用 TOS 托管加密密钥的服务端加密（SSE-TOS）或使用 KMS 托管加密密钥的服务端加密（SSE-KMS），则不应在 GET 请求中携带加密请求头域，如：x-tos-server-side-encryption，如果携带了该加密头域，会收到 HTTP 400 BadRequest 错误。
如果客户端在对象上传时，使用客户提供的加密密钥（SSE-C）进行服务端加密，当下载对象时，你必须携带以下头域：
x-tos-server-side-encryption-customer-algorithm
x-tos-server-side-encryption-customer-key
x-tos-server-side-encryption-customer-key-MD5
关于服务端加密的更多详细信息，请参见服务端加密概述。
注意事项
使用 GetObject 接口下载归档存储、冷归档存储和深度冷归档存储对象前，需要先恢复对象。
匿名请求说明
TOS 不允许在匿名访问的 Get 请求中自定义响应头域。详情请参见对象存储匿名请求限制说明。
请求消息样式
GET /objectName HTTP/1.1
Host: bucketname.tos-cn-beijing.volces.com
Date: GMT Date
Authorization: authorization string

请求参数和消息头
该请求的公共请求消息头，请参见公共参数。
名称
位置
参数类型
是否必选
示例值
说明
Range
Header
String
否
bytes=0-4
指定对象的获取范围。如未指定，则获取整个对象。Range 是一个范围，它的起始值最小为 0，最大为对象长度减 1。Range 范围的起始值为必填项，如果 Range 只包含起始值，表示获取起始值到对象长度减 1 这个区间的对象内容。格式为：bytes=start-end。
说明
携带 Range 头域后，响应消息的 ETag 仍是对象的 ETag，而不是 Range 范围内对象的 ETag。
If-Match
Header
String
否
8a36be0d764367db4eea2deb16b71543
只有当传入的 ETag 与对象的 ETag 相等才返回对象，否则返回 412 Precondition Failed。
If-Modified-Since
Header
String
否
Mon, 04 Jul 2022 02:57:31 GMT
只有在对象自指定时间以来被修改过时才返回该对象，否则返回 304 Not Modified。时间格式为 RFC1123 GMT。
If-None-Match
Header
String
否
8a36be0d764367db4eea2deb16b71543
只有当传入的 ETag 与对象的 ETag 不相等才返回对象，否则返回 304 Not Modified。
If-Unmodified-Since
Header
String
否
Mon, 04 Jul 2022 02:57:31 GMT
只有在对象自指定时间以来未被修改过时才返回该对象，否则返回412 Precondition Failed。时间格式为 RFC1123 GMT。
x-tos-server-side-encryption-customer-algorithm
Header
String
否，使用 SSE-C 加密时，必选。
AES256
对象是 SSE-C 加密时使用该头域，该头域表示解密对象使用的算法，取值说明如下：
AES256：使用 AES256 算法加密对象。
x-tos-server-side-encryption-customer-key
Header
String
否，使用 SSE-C 加密时，必选。
YWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWE=
与 x-tos-server-side-encryption-customer-algorithm 配套使用，指定 SSE-C 加密目标对象的密钥，格式为 base64 编码的 256 bit 的加密密钥。
x-tos-server-side-encryption-customer-key-md5
Header
String
否，使用 SSE-C 加密时，必选。
0gYVWExOAz67jX5A6qY4+A==
对象是 SSE-C 加密时使用该头域，与 x-tos-server-side-encryption-customer-key 配套使用，该头域表示解密对象使用的密钥的 MD5 值。该头域由密钥的 128-bit MD5 值经过 base64-encoded 得到，该值用于消息完整性检查，确认加密密钥在传输过程中没有出错。
x-tos-traffic-limit
Header
String
否
819200
TOS 提供单链接限速功能，在上传、下载文件等操作中进行流控控制，以保证其他应用的网络带宽。取值说明如下：
取值范围：245760-838860800，单位为bit/s
Header和Query中不能同时存在此参数
x-tos-traffic-limit
Query
String
否
819200
TOS 提供单链接限速功能，在上传、下载文件等操作中进行流控控制，以保证其他应用的网络带宽。取值说明如下：
取值范围：245760-838860800，单位为bit/s
Header和Query中不能同时存在此参数
response-content-disposition
Query
String
否
attachment; filename=123.txt
指定服务端返回的 Content-Disposition 响应头。
response-content-encoding
Query
String
否
gzip
指定服务端返回的 Content-Encoding 响应头。
response-content-language
Query
String
否
en-US
指定服务端返回的 Content-Language 响应头。
response-content-type
Query
String
否
text/plain
指定服务端返回的 Content-Type 响应头。
response-expires
Query
String
否
Mon, 04 Jul 2022 02:57:31 GMT
指定服务端返回的 Expires 响应头。
versionId
Query
String
否
123
获取指定版本号的对象。

请求元素
该请求消息中无请求元素。
响应消息头
该请求返回公共响应消息头，请参见公共参数。
说明
使用 GetObject 接口下载对象时，如果对象类型是软链接对象，则不同的响应头返回的内容不同，说明如下：
Content-Length、ETag 、x-tos-storage-class 和 x-tos-hash-crc64ecma：返回软链接对象指向的目标对象的信息。
Last-Modified：返回软链接对象和目标对象两者之间更新较晚的日期。
其他响应头：返回软链接对象信息。
名称
参数类型
示例值
说明
Content-Range
String
bytes 0-4/300
返回的对象数据范围。
Last-Modified
String
Mon, 02 Jul 2021 10:29:28 GMT
对象最后更新日期。
x-tos-delete-marker
Bool
true
对象是否标记删除。如果不是，不会返回此消息头。
x-tos-server-side-encryption
String
kms
对象是 SSE-TOS 加密或 SSE-KMS 时返回该头域，表示对象的服务端加密方式，取值如下：
AES256：使用 SSE-TOS 加密方式，并采用 AES256 加密算法。
SM4：使用 SSE-TOS 加密方式，并采用 SM4 加密算法。
kms: 使用 SSE-KMS 加密方式。
关于 SSE-TOS、 SSE-KMS 加密方式详细说明，请参见服务端加密概述。
x-tos-server-side-encryption-kms-key-id
String
trn:kms:cn-beijing:20000111:keyrings/ring-test/keys/key-test
对象采用 SSE-KMS 加密方式时返回该头域，该头域表示 SSE-KMS 加密使用的 KMS 主密钥 ID。
x-tos-server-side-encryption-customer-algorithm
String
AES256
对象是 SSE-C 加密时返回此头域，该头域表示解密使用的算法。
x-tos-server-side-encryption-customer-key-MD5
String
0gYVWExOAz67jX5A6qY4+A==
对象是 SSE-C 加密时返回此头域，该头域表示解密使用的密钥的 MD5 值。
x-tos-version-id
String
57AF1A32CECB56721267
对象的版本号。如果不存在版本号，则该消息头不会出现在响应消息中。
x-tos-website-redirect-location
String
/abc
当桶设置了 Website 配置，可以将获取这个对象的请求重定向到桶内另一个对象或一个外部的 URL，TOS 将这个值从头域中取出，保存在对象的元数据中。
x-tos-object-type
String
Symlink
对象为非 Normal 对象时，会返回此响应头，取值说明如下：
Appendable：该对象为追加写接口上传的对象。
Symlink：该对象为软链接对象。
x-tos-storage-class
String
STANDARD
对象的存储类型，取值说明如下：
STANDARD：标准存储。
IA：低频访问存储。
INTELLIGENT_TIERING：智能分层存储。
ARCHIVE_FR：归档闪回存储。
ARCHIVE：归档存储。
COLD_ARCHIVE：冷归档存储。
DEEP_COLD_ARCHIVE：深度冷归档存储。
x-tos-hash-crc64ecma
Integer
6186290338114851376
表示该对象的 64 位 CRC 值。该 64 位 CRC 根据 ECMA-182 标准计算得出。
说明
对 TOS 服务端支持 64 位 CRC 校验前创建的对象，则该消息头不会出现在响应消息中。
x‑tos‑tagging‑count
String
3
对象的标签个数。仅当拥有对象标签读取权限时返回。
X-Tos-Expiration
String
expiry-date="Sun, 25 Dec 2022 00:00:00 GMT"
对象的过期日期，存在以下两种情况：
如果该对象匹配生命周期的删除规则，则返回以下参数：
expiry-date：对象的过期日期。
rule-id：生命周期规则 ID。
如果该对象设置了过期时间，则会返回 expiry-date 参数，表示对象的过期日期，rule-id 参数则为空。
x-tos-replication-status
String
COMPLETE
对象的跨区域或同区域复制状态，存在以下两种情况：
如果是源存储桶的对象，该参数取值如下：
COMPLETE：该对象已成功复制到目标桶。
PENDING：该对象正在复制中。
FAILED：该对象复制失败。
如果是目标存储桶的对象，该参数只有一个取值，即 REPLICA，表示该对象是通过跨区域复制或同区域复制功能同步过来的。
注意
查询对象跨区域复制或同区域复制状态功能（即 x-tos-replication-status 参数）目前处于邀测状态，如您需要使用该功能，请联系客户经理。
仅该对象为跨区域复制或同区域复制规则中源存储桶或目标存储桶的对象时，才会返回该参数。
仅支持查询配置了一条跨区域复制规则或同区域复制规则的源存储桶的对象复制状态，例如在源存储桶设置了多条复制规则，将 A 对象复制到 B、C、D 存储桶，则不支持查询 A 对象的复制状态。目标存储桶的对象则没有该限制。
x-tos-restore
String
ARCHIVE
如果对象为归档、冷归档或深度冷归档对象（即存储类型为 ARCHIVE 、COLD_ARCHIVE 或 DEEP_COLD_ARCHIVE），会返回副本删除时间，例如
ongoing-request="false", expiry-date="Sat, 1 Jan 2022 00:00:00 GMT"。
x-tos-qos-delay-time
Integer
10
该头域表示请求被流控时长，单位为 ms。上传类请求会返回精确的被流控的时长；copy 类请求或者下载类请求会返回根据流控程度和文件大小估算出的被流控的时长。
x-tos-directory
Bool
true
如果桶类型为分层桶，且文件类型为目录时，会返回该头域。
x-tos-create-time
String
Mon, 02 Jul 2021 10:29:28 GMT
对象的创建日期。
x-tos-object-lock-mode
String
COMPLIANCE
对象保留策略的模式，取值仅为 COMPLIANCE，表示合规模式。
说明
您的账号需要拥有 GetObjectRetention 权限，才会返回 x-tos-object-lock-mode 参数。
x-tos-object-lock-retain-until-date
String
2025-01-01T00:00:00Z
对象被锁定的截止日期，在该日期内，对象不能被删除或覆盖。
说明
您的账号需要拥有 GetObjectRetention 权限，才会返回 x-tos-object-lock-retain-until-date 参数。

响应元素
该请求响应中无消息元素。
请求示例
GET /objectName HTTP/1.1
Host: bucketname.tos-cn-beijing.volces.com
Date: Fri, 30 Jul 2021 08:05:36 GMT
Authorization: authorization string

响应示例
HTTP/1.1 200 OK
Content-Type: text/plain
Content-Length: 120
Date: Fri, 30 Jul 2021 08:05:36 GMT
ETag: "900150983cd24fb0d6963f7d28e17f72"
Last-Modified: Mon, 02 Jul 2021 10:29:28 GMT
server: TosServer
x-tos-id-2: d604607e63b001f-a444ed0
x-tos-request-id: d604607e63b001f-a444ed0
x-tos-hash-crc64ecma: 6186290338114851376

[ 120 Bytes object content]
